<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style>
    circle {
        fill: lightblue;
        stroke: black;
    }
</style>

<body onload='init()'>
    <svg width=300 height=300>
    </svg>
    <script>
        async function init() {
            var data = await d3.csv("https://flunky.github.io/cars2017.csv");
            data.forEach(d => {
                d.EngineCylinders = +d.EngineCylinders;
                d.AverageCityMPG = +d.AverageCityMPG;
                d.AverageHighwayMPG = +d.AverageHighwayMPG;
            });
            console.log(data);

            const svg = d3.select("svg");

            // Set up the scales for mapping data to the SVG dimensions
            const xScale = d3
                .scaleLog()
                .domain([10, 150])
                .range([0, 200]).base(10);


            const yScale = d3
                .scaleLog()
                .domain([10, 150])
                .range([200, 0]).base(10);

            // Create circles for each data point
            svg.append("g").attr("transform", "translate(50,50)")
                .selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", (d) => xScale(d.AverageCityMPG))
                .attr("cy", (d) => yScale(d.AverageHighwayMPG))
                .attr("r", (d) => 2 + d.EngineCylinders);
            svg.append("g").attr("transform", "translate(50,50)").call(
                d3.axisLeft(yScale)
                    .tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s"))
            );
            svg.append("g").attr("transform", "translate(50,250)").call(
                d3.axisBottom(xScale)
                    .tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s"))
            );


        }
    </script>
</body>

</html>